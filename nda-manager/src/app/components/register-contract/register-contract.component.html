<div class="wizard-container">
  <!-- Header -->
  <app-contract-wizard-header [isEdit]="!!contractId()"></app-contract-wizard-header>
  
  <!-- Step Indicator -->
  <app-contract-wizard-step-indicator [currentStep]="currentStep()"></app-contract-wizard-step-indicator>

  <!-- Form -->
  <form (ngSubmit)="onSubmit()" class="wizard-form">
    <!-- Error/Success Messages -->
    @if (message()) {
      <app-message-container [message]="message()" />
    }

    <!-- Step 1: Basic Information -->
    @if (currentStep() === 1) {
      <app-contract-basic-info-step
        [title]="title()"
        [description]="description()"
        [loading]="loading()"
        (titleChange)="title.set($event)"
        (descriptionChange)="description.set($event)">
      </app-contract-basic-info-step>
    }

    <!-- Step 2: Contract Type Selection -->
    @if (currentStep() === 2) {
      <app-contract-type-selection-step
        [selectedContractType]="selectedContractType()"
        [loading]="loading()"
        (contractTypeChange)="selectContractType($event)">
      </app-contract-type-selection-step>
    }

    <!-- Step 3: Contract Details -->
    @if (currentStep() === 3) {
      <!-- URL Type -->
      @if (selectedContractType() === 'url') {
        <app-contract-url-details-step
          [uri]="uri()"
          [loading]="loading()"
          (uriChange)="uri.set($event)">
        </app-contract-url-details-step>
      }

      <!-- Contents Type -->
      @if (selectedContractType() === 'contents') {
        <app-contract-contents-details-step
          [content]="content()"
          [loading]="loading()"
          (contentChange)="content.set($event)">
        </app-contract-contents-details-step>
      }

      <!-- Model Type -->
      @if (selectedContractType() === 'model') {
        <app-contract-model-details-step
          [proprietaryCompanyName]="proprietaryCompanyName()"
          [scopeOfDiscussion]="scopeOfDiscussion()"
          [agreementValue]="agreementValue()"
          [authorizedContactPerson]="authorizedContactPerson()"
          [parties]="parties()"
          [feeStructure]="feeStructure()"
          [loading]="loading()"
          (proprietaryCompanyNameChange)="proprietaryCompanyName.set($event)"
          (scopeOfDiscussionChange)="scopeOfDiscussion.set($event)"
          (agreementValueChange)="agreementValue.set($event)"
          (authorizedContactPersonChange)="authorizedContactPerson.set($event)"
          (partiesChange)="parties.set($event)"
          (feeStructureChange)="feeStructure.set($event)">
        </app-contract-model-details-step>
      }
    }

    <!-- Form Actions -->
    <app-contract-wizard-actions
      [currentStep]="currentStep()"
      [totalSteps]="totalSteps"
      [loading]="loading()"
      [canProceed]="canProceedToNextStep()"
      [isEdit]="!!contractId()"
      (previousStep)="previousStep()"
      (nextStep)="onSubmit()"
      (cancel)="onCancel()">
    </app-contract-wizard-actions>
  </form>
</div>
